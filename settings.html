<div id="stepthink_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Stepped Thinking</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <div class="flex-container marginTopBot5">
                <label class="checkbox_label expander" for="stepthink_is_enabled">
                    <input id="stepthink_is_enabled" type="checkbox"/>
                    Enable Stepped Thinking
                </label>
            </div>

            <hr/>

            <div class="flex-container justifySpaceBetween alignItemsCenter">
                Prompts for thinking:
                <div id="stepthink_prompt_list_add" class="menu_button menu_button_icon fa-solid fa-plus"
                     title="Add prompt"></div>
            </div>

            <div id="stepthink_prompt_list"></div>

            <div class="flex-container marginTopBot5">
                <label class="checkbox_label expander" for="stepthink_is_wian_skipped"
                       title="Omit World Info and Author's Note from thought generation prompts">
                    <input id="stepthink_is_wian_skipped" type="checkbox"/>
                    Skip WI/AN
                </label>
            </div>

            <hr/>

            <div class="flex-container marginTopBot5">
                <div class="flex-container flex1"
                     title="The number of a character's last messages with thoughts that will be included in the generation prompt">
                    <label for="stepthink_max_thoughts_in_prompt">
                        Number of included thoughts for a character:
                    </label>
                    <input type="number" id="stepthink_max_thoughts_in_prompt" class="text_pole" min="0"/>
                </div>
            </div>

            <div class="flex-container justifySpaceBetween alignItemsCenter">
                <label for="stepthink_excluded_characters"
                       title="Do you want to exclude your narrator or anyone else from the thinking process? This option is for you. Also, pay attention that characters are identified by their names">
                    Characters with disabled thinking:
                </label>
                <div class="stepthink_load_characters menu_button menu_button_icon fa-solid fa-undo"
                     title="Reload characters list"></div>
                <select id="stepthink_excluded_characters" class="select2_multi_sameline"
                        multiple="multiple"></select>
            </div>

            <div class="flex-container justifySpaceBetween alignItemsCenter">
                <label for="stepthink_mind_reader_characters"
                       title="Another useful option for narrators - it allows characters from the list to read the thoughts of all other characters. Also, pay attention that characters are identified by their names">
                    Characters who read others' thoughts:
                </label>
                <div class="stepthink_load_characters menu_button menu_button_icon fa-solid fa-undo"
                     title="Reload characters list"></div>
                <select id="stepthink_mind_reader_characters" class="select2_multi_sameline"
                        multiple="multiple"></select>
            </div>

            <div class="flex-container marginTopBot5">
                <div id="stepthink_additional_settings_toggle" class="menu_button menu_button_icon">
                    <i class="fa-solid fa-cog"></i>
                    Additional Settings
                </div>
            </div>
            <div id="stepthink_additional_settings" style="display:none;">
                <div class="flex-container marginTopBot5">
                    <label class="checkbox_label expander" for="stepthink_is_thoughts_spoiler_open"
                           title="Whether spoilers will be open or closed in new messages. It doesn't affect existing ones">
                        <input id="stepthink_is_thoughts_spoiler_open" type="checkbox"/>
                        Thought spoilers are open by default
                    </label>
                </div>

                <div class="flex-container marginTopBot5">
                    <label class="checkbox_label expander" for="stepthink_is_thinking_popups_enabled"
                           title="Whether popups notifying about the progress of thinking will be shown">
                        <input id="stepthink_is_thinking_popups_enabled" type="checkbox"/>
                        Enable popups when a character is thinking
                    </label>
                </div>

                <div class="flex-container marginTopBot5">
                    <div class="flex-container flex1"
                         title="This setting restricts the response length for thinking prompts (in tokens). Leave it empty or set to 0 to disable">
                        <label for="stepthink_max_response_length">
                            Max response length for a thinking prompt:
                        </label>
                        <input type="number" id="stepthink_max_response_length" class="text_pole" min="0"/>
                    </div>
                </div>

                <div class="flex-container marginTopBot5">
                    <div class="flex-container flex1"
                         title="Certain APIs may experience issues when attempting too many generations in a short time; this option lets you set up a delay before each generation request. Fractional numbers are allowed">
                        <label for="stepthink_generation_delay">
                            Delay generation requests (seconds):
                        </label>
                        <input type="number" id="stepthink_generation_delay" class="text_pole" min="0"/>
                    </div>
                </div>

                <div class="flex-container marginTopBot5">
                    <div class="flex-container justifySpaceBetween alignItemsCenter flex1"
                         title="Often, there are special symbols and other shiza in the generation output; it will be removed by the regexp">
                        <label for="stepthink_regexp_to_sanitize">
                            Regexp to sanitize thoughts:
                        </label>
                        <div id="stepthink_restore_regexp_to_sanitize" class="menu_button margin0" title="Restore default regexp">Default</div>
                        <input type="text" id="stepthink_regexp_to_sanitize" class="text_pole textarea_compact"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
